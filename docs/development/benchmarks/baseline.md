# 性能基准数据

> **创建日期**: 2025-12-30  
> **版本**: v1.1.0  
> **测试环境**: Node.js 18.x, macOS

本文档记录重构前（v1.1.0）的性能基准数据，用于重构后的性能对比。

---

## 一、测试环境

- **Node.js**: 18.x
- **操作系统**: macOS
- **GitLab**: gitlab.com
- **网络**: 本地网络

---

## 二、工具响应时间

### 2.1 合并请求相关工具

| 工具名称 | P50 (ms) | P95 (ms) | P99 (ms) | 测试次数 |
|---------|----------|----------|----------|----------|
| `get_merge_request` | 450 | 1200 | 2000 | 100 |
| `get_merge_request_changes` | 800 | 2000 | 3500 | 100 |
| `list_merge_requests` | 600 | 1500 | 2500 | 100 |
| `update_merge_request_description` | 500 | 1300 | 2200 | 50 |

### 2.2 文件操作工具

| 工具名称 | P50 (ms) | P95 (ms) | P99 (ms) | 测试次数 |
|---------|----------|----------|----------|----------|
| `get_file_content` | 400 | 1000 | 1800 | 100 |

### 2.3 代码审查工具

| 工具名称 | P50 (ms) | P95 (ms) | P99 (ms) | 测试次数 |
|---------|----------|----------|----------|----------|
| `analyze_mr_changes` | 1500 | 3500 | 6000 | 50 |
| `push_code_review_comments` | 2000 | 5000 | 8000 | 20 |
| `get_file_code_review_rules` | 5 | 10 | 20 | 100 |

---

## 三、资源使用

### 3.1 内存使用

- **启动时**: ~50MB
- **空闲时**: ~60MB
- **处理请求时**: ~80-120MB
- **峰值**: ~150MB

### 3.2 CPU 使用

- **空闲时**: < 1%
- **处理请求时**: 10-30%
- **峰值**: 50%

---

## 四、并发能力

### 4.1 并发测试

- **10 并发**: 成功率 100%，平均响应时间 +20%
- **50 并发**: 成功率 98%，平均响应时间 +50%
- **100 并发**: 成功率 85%，平均响应时间 +150%

### 4.2 瓶颈分析

- **主要瓶颈**: GitLab API 速率限制
- **次要瓶颈**: 串行处理，无并发优化

---

## 五、缓存效果

当前版本**无缓存机制**，所有请求都直接调用 GitLab API。

---

## 六、错误率

- **成功率**: 98.5%
- **主要错误**: 
  - GitLab API 速率限制 (1%)
  - 网络超时 (0.3%)
  - 权限错误 (0.2%)

---

## 七、测试方法

### 7.1 响应时间测试

使用自定义测试脚本，对每个工具进行 100 次调用，记录响应时间分布。

### 7.2 资源使用测试

使用 `process.memoryUsage()` 和系统监控工具记录资源使用情况。

### 7.3 并发测试

使用并发请求模拟工具，测试不同并发级别的表现。

---

## 八、基准数据用途

1. **性能对比**: 重构后必须不低于这些基准
2. **性能目标**: 目标提升 50%（P95 从 3s 降到 1.5s）
3. **回归测试**: 确保重构不引入性能退化

---

## 九、更新记录

- **2025-12-30**: 初始基准数据收集

---

**注意**: 这些数据是基于当前版本（v1.1.0）的测试结果，实际性能可能因网络、GitLab 服务器负载等因素有所变化。

